<?phpclass ValidateSafePassword extends CActiveRecordExt {    public $password;    public $passwordconfirm;    public static function main($password = NULL, $passwordconfirm = NULL) {        $mensaje = array('resultado' => false, 'error' => '');        $password = trim($password);        $passwordconfirm = trim($passwordconfirm);        /* Valido q no sean vacios */        if ($password != NULL AND $passwordconfirm != NULL) {            /* Valido si son Iguales */            if ($password == $passwordconfirm) {                $mensaje['resultado'] = TRUE;                $mensaje['error'] = '';                /* Valido si es mayor o igual a 8 Caracteres */                if (strlen($password) >= 8) {                    $mensaje['resultado'] = TRUE;                    $mensaje['error'] = '';                    /* Valido si tiene 1 Numero */                    if (preg_match("#[0-9]+#", $password)) {                        $mensaje['resultado'] = TRUE;                        $mensaje['error'] = '';                        /* Debe tener una letra */                        if (preg_match("#[a-zA-Z]+#", $password)) {                            $mensaje['resultado'] = TRUE;                            $mensaje['error'] = '';                        } else {                            $mensaje['resultado'] = FALSE;                            $mensaje['error'] = 'La Contraseña debe contenter una letra (A-Z)';                        }                    } else {                        $mensaje['resultado'] = FALSE;                        $mensaje['error'] = 'La Contraseña debe tener minimo un numero';                    }                } else {                    $mensaje['resultado'] = FALSE;                    $mensaje['error'] = 'La Contraseña debe ser mayor o igual a 8 Caracteres';                }            } else {                $mensaje['resultado'] = FALSE;                $mensaje['error'] = 'La Contraseña debe ser igual';            }        } else {            $mensaje['resultado'] = FALSE;            $mensaje['error'] = 'Los Campos son requeridos';        }        return $mensaje;    }    public static function Hash($password) {        $hashcrypt = hash('sha256', $password);        return $hashcrypt;    }    public function attributeLabels() {        return array(            'lausername' => 'Usuario',            'lapassword' => 'Contraseña',            'laconfirmation' => 'Confirmacion',        );    }}